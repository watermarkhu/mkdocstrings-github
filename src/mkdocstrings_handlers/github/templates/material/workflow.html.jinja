{#- Template for GitHub Action reusable workflow.

Context:
  data (mkdocstrings_handlers.github.objects.Workflow): The workflow to render.
  config (mkdocstrings_handlers.github.config.GitHubConfig): The global configuration
  options (dict): The local options
-#}

{% block logs scoped %}
  {#- Logging block.

  This block can be used to log debug messages, deprecation messages, warnings, etc.
  -#}
  {{ log.debug("Rendering " + data.id) }}
{% endblock logs %}

<div class="doc doc-object doc-workflow">
  {% if options.show_heading %}
    {% filter heading(
      options.heading_level,
      role="workflow",
      id=data.id,
      class="doc doc-heading",
      toc_label=options.toc_label if options.toc_label else data.name,
    )%}
      {% block heading scoped %}
        {{ options.heading if options.heading else data.name }}
      {% endblock heading %}
    {% endfilter %}
  {% elif options.show_toc_entry %}
    {% filter heading(
      options.heading_level,
      role="action",
      id=data.id,
      class="doc doc-heading",
      toc_label=options.toc_label if options.toc_label else data.name,
    )%}
    {% endfilter %}
  {% endif %}

  {% block signature scoped %}
    {% if options.show_signature %}
      {% with inputs = data.inputs | order_parameters(options.parameters_order) | filter_parameters(required=True) %}
        {% filter highlight(language="yaml", inline=False, linenums=False) %}
          uses: {% filter format_action_signature(config.repo, options) %}{{ data.id }}{% endfilter +%}
          {% if options.signature_show_permissions and data.permissions %}
          permissions:
            {%+ for scope, level in data.permissions | items %}{{ scope }}: {{ level | string }}{% endfor +%}
          {% endif %}
          with:
            {%+ for input in inputs %}{{ input.name }}: ''{% endfor +%}
          {% if options.signature_show_secrets %}
            {% with secrets = data.secrets | order_parameters(options.parameters_order) | filter_parameters(required=True) %}
          secrets:
            {%+ for secret in secrets %}{{ secret.name }}: ''{% endfor +%}
            {% endwith %}
          {% endif %}
        {% endfilter %}
      {% endwith %}
    {% endif %}
  {% endblock signature %}

  {% block description scoped %}
    {% if options.show_description %}
      {{ options.description }}
    {% endif %}
  {% endblock description %}

  {% block inputs scoped %}
    {% if options.show_inputs %}
      {% with inputs = data.inputs | order_parameters(options.parameters_order) | filter_parameters(required=options.show_inputs_only_required) %}
        {% include "inputs.html.jinja" with context %}
      {% endwith %}
    {% endif %}
  {% endblock inputs %}

  {% block secrets scoped %}
    {% if options.show_secrets %}
      {% with secrets = data.secrets | order_parameters(options.parameters_order) | filter_parameters(required=options.show_secrets_only_required) %}
        {% include "secrets.html.jinja" with context %}
      {% endwith %}
    {% endif %}
  {% endblock secrets %}

  {% block outputs scoped %}
    {% if options.show_outputs %}
      {% with outputs = data.outputs | order_parameters(options.parameters_order) %}
        {% include "outputs.html.jinja" with context %}
      {% endwith %}
    {% endif %}
  {% endblock outputs %}

  {% block source scoped %}
    {% if options.show_source %}
      <details class="quote">
        <summary>Source of <code>
          {{ data.id }}
        </code></summary>
        {{ data.source|highlight(language="yaml", linenums=True) }}
      </details>
    {% endif %}
  {% endblock %}
</div>
